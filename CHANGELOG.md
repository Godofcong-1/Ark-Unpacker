更新日志 / CHANGELOG
==========
<sup> This project only supports Chinese docs. If you are an English user, feel free to contact us. </sup>

## v2.5
#### 优化
1. (重要) 优化了多线程分配逻辑，文件写入系统已支持多线程，提升了大型ab文件的解包速度。
2. (重要) 优化了程序的目录结构，分离了部分程序脚本。
3. 优化了默认配置，默认的最大执行线程数上调至16。


## v2.4
#### 修复
1. (重要) 修复了无法正确导出多纹理的Spine模型（例如岁相、部分干员动态立绘）文件的问题。

#### 优化
1. (重要) 重构了命令行界面的打印方式，现在采用Unicode控制符进行更美观高效的打印和清除行的操作。
2. 优化了删除目录树的方式，提升了删除的速度。
3. 优化了“ArkModels提取与分拣工具”的分拣逻辑，提升了分拣的速度。
4. 优化了解包时的多线程分配逻辑，提升了解包的速度。


## v2.3
#### 新增
1. (重要) 新增了日志系统。程序运行时会在工作目录保存日志文件，以便后续的检查和故障排除等操作。
2. (重要) 新增了配置文件。程序启动时会在工作目录读取配置文件，用户可以通过编辑该文件来调整部分设置参数。

#### 修复
1. (重要) 修复了战斗小人与基建小人重名等特定情况下，无法正确分类导出Spine模型文件的问题。现在基建小人会单独导出到 `Building` 子目录中。

#### 优化
1. 优化了读取文件列表时的性能和效率。


## v2.2
#### 新增
1. (重要) 新增了“ArkModels提取与分拣工具”对于敌方模型的提取与分拣支持。

#### 修复
1. (重要) 修复了战斗小人图片正背面图片区分不准确的问题 ([#4](https://github.com/isHarryh/Ark-Unpacker/issues/4))。


## v2.1
#### 新增
1. (重要) 支持新功能“ArkModels提取与分拣工具”，详情参见[附加文档](docs/ArkModelsRepoKit.md)。


## v2.0
> 此版本发生了革命性的变化
#### 新增
1. (重要) 支持且默认以多线程模式运行资源解包和图片合并。多线程以增加单位时间内的性能消耗为代价，极大地提升了运行速度。
2. 支持在自定义模式下用户可以选择最大执行线程数。

#### 优化
1. 优化了运行时的回显表现和打印速度。
2. 优化了图片匹配的精确度，调整了算法的参数。

#### 修复
1. (重要) 修复了特定情况下保存目的地异常的问题：现在任务目标相对路径含有 `..` 时，也能被正确地保存。

#### 其他
1. 整理了说明文档，建立独立目录 `docs` 用于存储附加说明文档。
2. 不再支持流式显示运行时的详细信息，现在都只以简洁模式（进度条模式）回显信息。

#### 测试数据
该版本在作者的电脑上测试结果如下：
> 电脑配置  
> -- Windows 10 (64位)  
> -- CPU 2.00GHz, RAM 8.00GB  
> 明日方舟版本  
> -- Android v1.9.01  
> 测试内容  
> -- “一键执行”整个Android文件夹  
> -- 线程模式：8线程
> -- 源文件夹：5.19GB(6.8K个文件)  
> 测试结果  
> -- 用时：1.5h  
> -- 资源解包文件夹：13.5GB(61K个文件)  
> -- 图片合并文件夹：2.04GB(5.8K个文件)  

-----

## v1.2
#### 新增
1. (重要) 支持将不同ab文件中解包出的文件分别放到不同的子文件夹中，以便分类保存。
2. (重要) 支持显示任务的剩余时间。

#### 优化
1. 优化了目录创建的回显：现在不会轻易回显这类信息，以提升运行速度。

#### 测试数据
该版本在作者的电脑上测试结果如下：
> 电脑配置  
> -- Windows 10 (64位)  
> -- CPU 2.00GHz, RAM 8.00GB  
> 明日方舟版本  
> -- Android v1.8.81  
> 测试内容  
> -- “一键执行”整个Android文件夹  
> -- 源文件夹：5.06GB(6.6K个文件)  
> 测试结果  
> -- 用时：3.0h  
> -- 资源解包文件夹：20.1GB(70K个文件)  
> -- 图片合并文件夹：2.03GB(5.2K个文件)  


## v1.1
#### 新增
1. 新增了程序运行时的图标和窗口标题。

#### 优化
1. 优化了各种代码逻辑，以提升运行效率和代码易读性。
2. (重要) 优化了字符串的拼接：使用了 `f-string` 来提升字符串的拼接速度和代码易读性。
3. (重要) 优化了文件列表的解析和筛选逻辑：使用 `filter` 对文件列表执行初筛以提升运行速率。
4. (重要) 优化了文件的保存逻辑：当文件夹内存在文件名相似、内容完全相同的文件时，不会进行保存操作。
5. (重要) 优化了图片合并的算法：现在使用 `PIL.Image` 的内置函数 `putalpha` 来合并RGB通道图和A通道图。经测试，图片合并的运行速率提升了约4倍。
6. 优化了图片合并时的信息回显。

#### 修复
1. (重要) 修复了干员战斗小人相关资源由于重名而不能正确地全部导出的问题。
2. 修复了图片合并时，不能按目录分别保存的问题。
3. (重要) 修复了干员战斗小人相关图片无法被正确地匹配和合并的问题。
4. (重要) 修复了重名的文件保存冲突的问题：现在会自动添加 `_#` 后缀来区分重名的文件，且不再需要用户配置是否执行覆盖(docover)。
5. 修复了在试图保存大小为0的图片时报出意外错误的问题：现在这些无用图片会被直接跳过。
6. (重要) 修复了不能准确匹配RGB通道图和A通道图的问题，此问题主要发生在针对资源文件夹 `skinpack` 内的图片的合并中：经过算法调整已能正确匹配，但不排除还有极个别匹配错误。

#### 其他
1. 解决了可执行文件中可能潜在的 `fmod.dll` 缺失的问题。
2. 采用了文件虚拟化技术打包可执行文件。

#### 测试数据
该版本在作者的电脑上测试结果如下：
> 电脑配置  
> -- Windows 10 (64位)  
> -- CPU 2.00GHz, RAM 8.00GB  
> 明日方舟版本  
> -- Android v1.8.01  
> 测试内容  
> -- “一键执行”整个Android文件夹  
> -- 源文件夹：4.74GB(5.9K个文件)  
> 测试结果  
> -- 用时：2.5h  
> -- 资源解包文件夹：18.4GB(57K个文件)  
> -- 图片合并文件夹：1.90GB(5.4K个文件)  
